<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title></title>
	<meta name="generator" content="LibreOffice 7.6.4.1 (Linux)"/>
	<meta name="created" content="00:00:00"/>
	<meta name="changed" content="00:00:00"/>
	<style type="text/css">
		@page { size: 8.27in 11.69in; margin: 0.79in }
		p { line-height: 115%; margin-bottom: 0.1in; background: transparent }
		pre { background: transparent }
		pre.western { font-family: "Liberation Mono", monospace; font-size: 10pt }
		pre.cjk { font-family: "NSimSun", monospace; font-size: 10pt }
		pre.ctl { font-family: "Liberation Mono", monospace; font-size: 10pt }
	</style>
</head>
<body lang="en-US" link="#000080" vlink="#800000" dir="ltr"><pre class="western">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;UTF-8&quot; /&gt;
  &lt;title&gt;Workshop Agenda Builder&lt;/title&gt;
  &lt;style&gt;
    body { font-family: Arial, sans-serif; margin: 30px; }
    label, select, input, button {
      width: 100%; padding: 10px; margin-top: 10px;
    }
    table {
      width: 100%; border-collapse: collapse; margin-top: 20px;
    }
    th, td {
      border: 1px solid #ccc; padding: 10px;
    }
    th {
      background: #eee;
    }
  &lt;/style&gt;
  &lt;script src=&quot;https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js&quot;&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;h2&gt;Workshop Agenda Builder&lt;/h2&gt;

&lt;label for=&quot;topic&quot;&gt;Topic&lt;/label&gt;
&lt;select id=&quot;topic&quot;&gt;&lt;option value=&quot;&quot;&gt;Loading topics...&lt;/option&gt;&lt;/select&gt;

&lt;label for=&quot;subtopics&quot;&gt;Sub-topic(s)&lt;/label&gt;
&lt;select id=&quot;subtopics&quot; multiple size=&quot;6&quot; disabled&gt;&lt;/select&gt;

&lt;label for=&quot;startTime&quot;&gt;Start Time&lt;/label&gt;
&lt;input type=&quot;time&quot; id=&quot;startTime&quot;&gt;

&lt;label for=&quot;duration&quot;&gt;Duration (minutes)&lt;/label&gt;
&lt;select id=&quot;duration&quot;&gt;
  &lt;option value=&quot;30&quot;&gt;30&lt;/option&gt;
  &lt;option value=&quot;45&quot;&gt;45&lt;/option&gt;
  &lt;option value=&quot;60&quot; selected&gt;60&lt;/option&gt;
&lt;/select&gt;

&lt;label for=&quot;mode&quot;&gt;Facilitation Mode&lt;/label&gt;
&lt;select id=&quot;mode&quot;&gt;
  &lt;option value=&quot;&quot;&gt;-- Select Mode --&lt;/option&gt;
  &lt;option&gt;Form Responses&lt;/option&gt;
  &lt;option&gt;Discussion&lt;/option&gt;
  &lt;option&gt;Presentation&lt;/option&gt;
  &lt;option&gt;Activity&lt;/option&gt;
  &lt;option&gt;Discussion+Activity&lt;/option&gt;
  &lt;option&gt;Presentation+Activity&lt;/option&gt;
  &lt;option&gt;Presentation+Form Responses&lt;/option&gt;
&lt;/select&gt;

&lt;label for=&quot;facilitator&quot;&gt;Facilitator&lt;/label&gt;
&lt;input type=&quot;text&quot; id=&quot;facilitator&quot; placeholder=&quot;Facilitator Name&quot; /&gt;

&lt;button onclick=&quot;addToAgenda()&quot;&gt;Add to Agenda&lt;/button&gt;

&lt;h3&gt;Agenda&lt;/h3&gt;
&lt;table id=&quot;agendaTable&quot;&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Time&lt;/th&gt;
      &lt;th&gt;Session&lt;/th&gt;
      &lt;th&gt;Learning Objective&lt;/th&gt;
      &lt;th&gt;Mode&lt;/th&gt;
      &lt;th&gt;Facilitator&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;&lt;/tbody&gt;
&lt;/table&gt;

&lt;button onclick=&quot;downloadExcel()&quot;&gt;Download as Excel&lt;/button&gt;

&lt;script&gt;
const csvUrl = &quot;https://docs.google.com/spreadsheets/d/e/2PACX-1vTA9WJB4yhBjiiE7nUo34v-VcN6wK-2HyMqXxU_WHTWs4xwtKc72fF4tmaKxCf9RrJ0W2s6vdJgbYFo/pub?gid=0&amp;single=true&amp;output=csv&quot;;

const topicSelect = document.getElementById(&quot;topic&quot;);
const subTopicSelect = document.getElementById(&quot;subtopics&quot;);
const agendaBody = document.querySelector(&quot;#agendaTable tbody&quot;);

fetch(csvUrl)
  .then(res =&gt; res.text())
  .then(csv =&gt; {
    const rows = csv.trim().split(&quot;\n&quot;).map(row =&gt; row.split(&quot;,&quot;));
    const headers = rows[0];
console.log(&quot;Headers found:&quot;, headers);
alert(&quot;Headers found: &quot; + headers.join(&quot;, &quot;));
    const clean = str =&gt; str.replace(/\uFEFF/g, '').trim().toLowerCase();
const lowerHeaders = headers.map(clean);
const topicIdx = lowerHeaders.findIndex(h =&gt; h === 'topic');
const subIdx = lowerHeaders.findIndex(h =&gt; h === 'sub-topic');
    if (topicIdx === -1 || subIdx === -1) {
      alert(&quot;CSV must have 'Topic' and 'Sub-topic' headers.&quot;);
      return;
    }

    const topicMap = {};
    rows.slice(1).forEach(row =&gt; {
      const topic = row[topicIdx]?.trim();
      const sub = row[subIdx]?.trim();
      if (!topic || !sub) return;
      if (!topicMap[topic]) topicMap[topic] = [];
      if (!topicMap[topic].includes(sub)) topicMap[topic].push(sub);
    });

    topicSelect.innerHTML = '&lt;option value=&quot;&quot;&gt;-- Select Topic --&lt;/option&gt;';
    Object.keys(topicMap).forEach(topic =&gt; {
      topicSelect.add(new Option(topic, topic));
    });

    topicSelect.addEventListener(&quot;change&quot;, () =&gt; {
      subTopicSelect.innerHTML = &quot;&quot;;
      const subs = topicMap[topicSelect.value] || [];
      subs.forEach(sub =&gt; subTopicSelect.add(new Option(sub, sub)));
      subTopicSelect.disabled = subs.length === 0;
    });
  })
  .catch(err =&gt; {
    console.error(&quot;CSV Load Error:&quot;, err);
    alert(&quot;Failed to fetch data from Google Sheet.&quot;);
  });

function toDate(timeStr) {
  const [h, m] = timeStr.split(&quot;:&quot;).map(Number);
  const d = new Date();
  d.setHours(h, m, 0);
  return d;
}

function formatTime(d) {
  return d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
}

function addToAgenda() {
  const subs = Array.from(subTopicSelect.selectedOptions).map(o =&gt; o.value);
  const time = document.getElementById(&quot;startTime&quot;).value;
  const dur = parseInt(document.getElementById(&quot;duration&quot;).value);
  const mode = document.getElementById(&quot;mode&quot;).value;
  const facilitator = document.getElementById(&quot;facilitator&quot;).value || &quot;—&quot;;

  if (!subs.length || !time || !dur || !mode) {
    alert(&quot;Please complete all fields.&quot;);
    return;
  }

  const start = toDate(time);
  const end = new Date(start.getTime() + dur * 60000);
  const timeSlot = `${formatTime(start)} – ${formatTime(end)}`;

  subs.forEach(sub =&gt; {
    const row = agendaBody.insertRow();
    row.insertCell().textContent = timeSlot;
    row.insertCell().textContent = sub;
    row.insertCell().textContent = `Understand ${sub}`;
    row.insertCell().textContent = mode;
    row.insertCell().textContent = facilitator;
  });

  // Reset form
  topicSelect.value = &quot;&quot;;
  subTopicSelect.innerHTML = &quot;&quot;;
  subTopicSelect.disabled = true;
  document.getElementById(&quot;startTime&quot;).value = &quot;&quot;;
  document.getElementById(&quot;mode&quot;).value = &quot;&quot;;
  document.getElementById(&quot;facilitator&quot;).value = &quot;&quot;;
}

function downloadExcel() {
  const data = [[&quot;Time&quot;, &quot;Session&quot;, &quot;Learning Objective&quot;, &quot;Mode&quot;, &quot;Facilitator&quot;]];
  document.querySelectorAll(&quot;#agendaTable tbody tr&quot;).forEach(row =&gt; {
    const cells = Array.from(row.cells).map(cell =&gt; cell.textContent);
    data.push(cells);
  });

  const ws = XLSX.utils.aoa_to_sheet(data);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, &quot;Agenda&quot;);
  XLSX.writeFile(wb, &quot;Workshop_Agenda.xlsx&quot;);
}
&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;</pre>
</body>
</html>